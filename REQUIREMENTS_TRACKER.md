# TLSM v1.0 요구사항 추적 문서

**작성일**: 2025-11-28
**최종 업데이트**: 2025-11-28

---

## 1. 점검 이력 관련

### 1.1 마커 클릭 시 팝업 표시 ✅ 완료
- **요구사항**: 점검 이력에서 마커 클릭 시 화면 중앙에 팝업 표시
- **파일**: `site-detail.html`, `js/gis-renderer.js`
- **상태**: ✅ 완료
- **구현 내용**:
  - `.inspection-simple-popup`: 화면 중앙에 팝업 표시 (top: 50%, left: 50%)
  - `onInspectionMarkerClick()`: 마커 클릭 시 팝업 표시
- **변경 이력**:
  - 2025-11-28: 좌표 표시 기능 추가 후 삭제 (사용자 요청으로 취소)

---

## 2. 당해시설 점검표 관련

### 2.1 빈 행 제거 및 rowspan 수정 ✅ 완료
- **요구사항**: 구분 파트에서 빈 행 제거 및 테이블 구조 수정
  - 첫 행부터 바로 "세굴" 항목이 시작되어야 함 (설계서 14페이지)
  - rowspan 값이 실제 항목 개수와 일치해야 함
- **파일**: `inspection-checklist.html`
- **상태**: ✅ 완료
- **수정 내용**:
  - 빈 행 제거: 기초부, 전면부, 상단부의 rowspan 셀을 첫 데이터 행과 병합
  - rowspan 수정:
    - 당해시설: 12 → 13 (기초부 3 + 전면부 7 + 상단부 3)
    - 전면부: 8 → 7 (실제 항목 개수)
    - 상단부: 4 → 3 (실제 항목 개수)

### 2.2 오탈자 및 레이아웃 검토 ✅ 완료
- **요구사항**: 당해시설 점검표의 오탈자 및 레이아웃 재검토
  - 설계서, 참고자료와 정확히 일치해야 함
  - 디자인 시안이 아닌 **설계서 기준**
- **파일**: `inspection-checklist.html`
- **상태**: ✅ 완료 (2025-11-28)
- **참고 자료**:
  - `참고자료/전통 조경 시범서비스 서비스 플로우_v1.1.pdf` (14페이지)
  - `참고자료/점검항목(석축 및 옹벽).xlsx`
  - `참고자료/송부용(낙선재)/안전 점검 실시 (점검표)/석축/`

### 2.3 비고 열 사용 여부 ✅ 확인 완료
- **요구사항**: 점검표 비고 열의 사용 여부 확인
- **상태**: ✅ 확인 완료
- **결과**: 비고 열은 유지 (8개 컬럼 유지)

### 2.4 추가 피해요소 점검표 레이아웃 수정 ✅ 완료
- **요구사항**: 추가 피해요소 점검표 레이아웃 수정
  - 플로우 문서 15페이지 기준
  - 수직 텍스트 "추가피해요소" 표시 오류 수정
  - colspan/rowspan 구조 수정
- **파일**: `inspection-checklist.html` (692-740행)
- **상태**: ✅ 완료 (2025-11-28)
- **수정 내용**:
  - 수직 텍스트 역순 수정: "추가피해요소" → "소요해피가추" (CSS vertical-rl 대응)
  - 헤더 colspan 수정: 5 → 4
  - "유형" 행 구조 수정: 5개 체크박스를 colspan="4" 단일 셀로 병합
  - "유형" 행에 비고 셀 추가

---

## 3. 점검결과 입력 페이지 관련

### 3.1 점검결과 입력 테이블 레이아웃 수정 ✅ 완료
- **요구사항**: 점검결과 입력 테이블이 플로우 문서 15페이지와 다름
  - "점검결과"와 "보수정비 필요성" 셀이 2행 병합되어야 함
  - tbody 3행 제거 필요
- **파일**: `inspection-result.html` (395-456행)
- **상태**: ✅ 완료 (2025-11-28)
- **수정 내용**:
  - thead 구조 변경:
    - 1행: "점검결과"(rowspan=2), "보수정비 필요성"(rowspan=2), 등급 헤더 5개, "비고"
    - 2행: 등급별 라디오 버튼 5개, 비고 입력
  - tbody 행 삭제 (thead 2행만 유지)
- **최종 구조**:
  ```
  thead 1행: [점검결과(2행병합)] [보수정비필요성(2행병합)] [안전] [관심] [주의] [경계] [위험] [비고]
  thead 2행:                                                [radio][radio][radio][radio][radio][input]
  ```

---

## 4. 제출하기 팝업 관련

### 4.1 제출하기 버튼 팝업 표시 ✅ 완료
- **요구사항**: 제출하기 버튼 클릭 시 팝업이 나타나지 않고 검정 화면만 표시됨
- **파일**: `inspection-confirm.html`
- **상태**: ✅ 완료 (2025-11-28)
- **해결 방법**:
  - modal-overlay z-index: 500 → 9999
  - modal z-index: 501 → 10000
  - modal-overlay에 width: 100%, height: 100% 추가

---

## 5. 안전 점검 보고서 관련

### 5.1 동적 데이터 반영 ✅ 완료
- **요구사항**: 안전 점검 보고서에 동적 데이터 반영
  - 현재 정적 이미지로 표시됨
  - 사용자의 이전 단계 선택 값 반영 필요
- **파일**: `inspection-confirm.html`
- **상태**: ✅ 완료 (2025-11-28)
- **구현 내용**:
  - `updateChecklistDisplay()` 함수 추가: sessionStorage 데이터 기반 체크리스트 업데이트
  - `updateCheckboxInTable()` 함수 추가: 테이블 내 체크박스 상태 업데이트
  - `updateFinalInfo()` 함수 확장: 등급 표시에 색상 코딩 적용

---

## 6. 점검표 동적 렌더링 관련

### 6.1 대상 유형별 점검표 변경 ✅ 완료
- **요구사항**: 점검표가 대상 유형(석축, 담장, 수목 등)에 따라 다르게 표시되어야 함
  - 현재는 석축 및 옹벽만 하드코딩되어 있음
- **파일**: `inspection-checklist.html`
- **상태**: ✅ 완료 (2025-11-28)
- **구현 내용**:
  - `ChecklistTemplates` 모듈 추가: 6가지 대상 유형별 점검표 템플릿 구현
    - 석축 및 옹벽: 기초부(3항목), 전면부(7항목), 상단부(3항목)
    - 담장: 석축과 동일한 구조
    - 수목(단일목): 뿌리(4항목), 근원(2항목), 줄기(4항목), 가지(2항목)
    - 수목(군락): 구조적요소(7항목), 생리적요소(3항목)
    - 굴뚝: 기초부(2항목), 몸체부(4항목), 상부(2항목)
    - 집수정: 바닥부(6항목), 벽체부(3항목), 덮개부(3항목)
  - `AdditionalChecklistTemplate` 모듈: 추가 피해요소 점검표 템플릿
  - `renderChecklistByTarget()` 함수: URL 파라미터 `target`에 따라 동적 렌더링
  - 기존 `loadDynamicForm()`: JSON 데이터 기반 렌더링 (id 파라미터 사용 시)
- **참고 자료**:
  - `참고자료/송부용(낙선재)/안전 점검 실시 (점검표)/석축/`
  - `참고자료/송부용(낙선재)/안전 점검 실시 (점검표)/담장/`
  - `참고자료/송부용(낙선재)/안전 점검 실시 (점검표)/수목(단일목, 군락지)/`
  - `참고자료/송부용(낙선재)/안전 점검 실시 (점검표)/굴뚝/`
  - `참고자료/송부용(낙선재)/안전 점검 실시 (점검표)/집수정/`

---

## 7. 재해 이력 관련

### 7.1 테이블 헤더 수정 ✅ 완료 (이전 세션)
- **요구사항**:
  - 특기사항 → 복구완성
  - 지역 → 지점
  - 재해 대상 → 재해방상
- **파일**: `site-detail.html`
- **상태**: ✅ 완료

### 7.2 데이터 띄어쓰기 수정 ✅ 완료 (이전 세션)
- **요구사항**: 재해 이력 데이터의 띄어쓰기 정리
- **파일**: `data/nakseonjae/disaster-history.json`
- **상태**: ✅ 완료
- **수정 사항**:
  - "창덕궁낙선재권역" → "창덕궁 낙선재 권역"
  - "낙재화청정경원" → "낙선재 화청정 경원"

---

## 8. 수리 이력 관련

### 8.1 비용 단위 수정 ✅ 완료 (이전 세션)
- **요구사항**: 예산 단위를 "원"에서 "천원"으로 표기
- **파일**: `site-detail.html`
- **상태**: ✅ 완료

---

## 진행 상태 요약

| 구분 | 완료 | 진행중 | 대기 | 미해결 |
|------|------|--------|------|--------|
| 1. 점검 이력 | 1 | 0 | 0 | 0 |
| 2. 당해시설 점검표 | 5 | 0 | 0 | 0 |
| 3. 점검결과 입력 | 1 | 0 | 0 | 0 |
| 4. 제출하기 팝업 | 1 | 0 | 0 | 0 |
| 5. 안전 점검 보고서 | 1 | 0 | 0 | 0 |
| 6. 점검표 동적 렌더링 | 1 | 0 | 0 | 0 |
| 7. 재해 이력 | 2 | 0 | 0 | 0 |
| 8. 수리 이력 | 1 | 0 | 0 | 0 |
| **합계** | **13** | **0** | **0** | **0** |

---

## 우선순위

### P0 (긴급) - 모두 완료
1. ✅ **제출하기 팝업 미표시 문제** (4.1) - z-index 수정으로 해결
2. ✅ **당해시설 점검표 오탈자 및 레이아웃** (2.2) - 완료

### P1 (높음) - 모두 완료
3. ✅ **안전 점검 보고서 동적 데이터 반영** (5.1) - sessionStorage 기반 동적 데이터 구현
4. ✅ **점검표 대상 유형별 동적 렌더링** (6.1) - 6가지 유형별 템플릿 구현 완료

---

## 참고 문서

- **설계서**: `참고자료/전통 조경 시범서비스 서비스 플로우_v1.1.pdf`
- **참고 자료**: `참고자료/송부용(낙선재)/`
- **계획 문서**: `C:\Users\user\.claude\plans\wobbly-weaving-avalanche.md`
